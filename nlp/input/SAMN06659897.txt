An enormous diversity of previously unknown bacteria and archaea have been discovered recently, but their functional capacities and distributions in the terrestrial subsurface remain uncertain. We applied genome-resolved metagenomics, single-cell genomics and geochemical analyses to investigate ecosystems in sandstone-hosted aquifers that were accessed by continually sampling an erupting CO2-driven geyser (Colorado Plateau, Utah, USA) over five days. Here, we defined microbial communities and linked them to their source regions based on variations in the physical and chemical characteristics of the associated groundwater. Autotrophic Altiarchaeum sp. and phylogenetically deep-branching nanoarchaea colonize the deepest aquifer. One nanoarchaeum with limited metabolic capacity is inferred to be a symbiont of the Altiarchaeum. In contrast, autotrophic Sulfurimonas sustained by aerobic sulfide oxidation and with the capacity for N2 fixation dominates the shallow aquifer. Candidate Phyla Radiation bacteria and microaerophilic Fe- and S-oxidizers are abundant when the intermediate aquifer contributes to the geyser groundwater. Under these conditions, the Fe- and S-oxidizers proliferate due to their high replication rates. The results demonstrate pronounced stratification in microbiome composition, with 106 different phylum-level lineages present in the three aquifers and high diversity and archaeal dominance in the the deeper subsurface.